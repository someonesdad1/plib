# vi: wm=0 tw=0

# Table 3 in Nimeroff, pg 482.  This is the proposed CIE tristimulus 
# functions for a 10° observer with variances and covariances.
# v(x) = variance of x
# c(x, y) = covariance of x, y
# x = xbar (mean)
# y = xbar (mean)
# z = xbar (mean)
# This table was checked against the printed document, column by column.  
# Around 15-20 single digit errors were found and corrected.  The raw data 
# was copied to the clipboard from my PDF client.

# λ      x          y          z         v(x)         v(y)       v(z)            c(x, y)       c(x, z)          c(y, z)
table3 = '''
    400 0.0191097  0.0020044  0.0860109   0.000126    0.00000118   0.00256         +0.0000104    +0.000568        +0.0000467
    410 0.084736   0.008756   0.389366    0.000661    0.0000110    0.0132          +0.0000708    +0.00294         +0.000321
    420 0.204492   0.021391   0.972542    0.000937    0.0000262    0.0193          +0.0000731    +0.00421         +0.000350
    430 0.314679   0.038676   1.55348     0.000737    0.0000671    0.0154          +0.000106     +0.00329         +0.000509
    440 0.383734   0.062077   1.96728     0.000385    0.0000448    0.00978         +0.0000816    +0.00189         +0.000355
    450 0.370702   0.089456   1.99480     0.000353    0.0000561    0.00815         +0.0000413    +0.00161         +0.000185
    460 0.302273   0.128201   1.74537     0.00109     0.0000995    0.0206          -0.0000151    +0.00454         +0.000136
    470 0.195618   0.185190   1.31756     0.00110     0.000272     0.0180          -0.000101     +0.00423         -0.000131
    480 0.080507   0.253589   0.772125    0.000716    0.000602     0.00606         -0.000108     +0.00182         -0.00000827
    490 0.016172   0.339133   0.415254    0.000675    0.00105      0.00234         -0.0000633    +0.000973        +0.0000759
    500 0.003816   0.460777   0.218502    0.000414    0.00129      0.000593        +0.000000553  +0.000279        -0.000245
    510 0.037465   0.606741   0.112044    0.000325    0.000829     0.000190        +0.000884     +0.000112        -0.0000999
    520 0.117749   0.761757   0.060709    0.000183    0.000457     0.0000649       +0.000109     +0.0000325       -0.0000185
    530 0.236491   0.875211   0.030451    0.000143    0.000253     0.0000271       +0.000100     +0.00000547      -0.00000204
    540 0.376772   0.961988   0.013676    0.000622    0.000590     0.0000431       +0.00301      +0.0000133       -0.0000285
    550 0.529826   0.991761   0.003988    0.00143     0.000668     0.000105        +0.000528     +0.0000531       -0.0000700
    560 0.705224   0.997340   0.000000    0.00283     0.000847     0.000100        +0.000960     +0.000102        -0.0000513
    570 0.878655   0.955552   0.000000    0.00437     0.000998     0.0000942       +0.00142      +0.000147        -0.0000107
    580 1.01416    0.868934   0.000000    0.00569     0.00113      0.0000778       +0.00181      +0.000184        +0.0000381
    590 1.11852    0.777405   0.000000    0.00588     0.000947     0.0000652       +0.00194      +0.000194        +0.0000806
    600 1.12399    0.658341   0.000000    0.00493     0.000731     0.0000379       +0.00170      +0.000148        +0.0000720
    610 1.03048    0.527963   0.000000    0.00324     0.000475     0.0000248       +0.00116      +0.000102        +0.0000518
    620 0.856297   0.398057   0.000000    0.00159     0.000240     0.0000123       +0.000601     +0.0000449       +0.0000222
    630 0.647467   0.283493   0.000000    0.000575    0.0000918    0.00000587      +0.000226     +0.0000120       +0.00000591
    640 0.431567   0.179828   0.000000    0.0000750   0.0000127    0.000000280     +0.0000305    +0.000000138     +0.000000067
    650 0.268329   0.107633   0.000000    0.0000470   0.00000794   0.000000050     +0.0000191    +0.000000052     +0.000000032
    660 0.152568   0.060281   0.000000    0.0000458   0.00000713   0.000000043     +0.0000179    +0.000000166     +0.000000091
    670 0.0812606  0.0318004  0.000000    0.0000129   0.00000192   0.000000016     +0.00000492   +0.000000084     +0.000000044
    680 0.0408508  0.0159051  0.000000    0.00000427  0.000000619  0.0000000017    +0.00000161   +0.000000013     +0.0000000077
    690 0.0199413  0.0077488  0.000000    0.000000894 0.000000128  0.00000000043   +0.000000335  +0.0000000030    +0.0000000016
    700 0.00957688 0.00371774 0.000000    0.000000366 0.000000052  0.00000000016   +0.000000137  +0.00000000088   +0.00000000049
    710 0.00455263 0.00176847 0.000000    0.000000114 0.000000016  0.000000000039  +0.000000042  +0.00000000012   +0.000000000086
    720 0.00217496 0.00084619 0.000000    0.000000019 0.0000000026 0.0000000000043 +0.0000000069 +0.0000000000027 +0.0000000000051
'''[1:-1]

# Table 4 in Nimeroff, pg 483
# Within-observer variances in xbar, ybar, zbar
# v(x) = variance of xbar
# v(y) = variance of ybar
# v(z) = variance of z
table4 = '''
    400 0.00000390     0.0000000364    0.0000788
    410 0.0000204      0.000000338     0.000407
    420 0.0000288      0.000000806     0.000595
    430 0.0000227      0.00000207      0.000475
    440 0.0000119      0.00000138      0.000301
    450 0.0000109      0.00000173      0.000251
    460 0.0000337      0.00000306      0.000635
    470 0.0000340      0.00000837      0.000556
    480 0.0000220      0.0000185       0.000187
    490 0.0000208      0.0000322       0.0000720
    500 0.0000128      0.0000396       0.0000183
    510 0.0000100      0.0000255       0.00000587
    520 0.00000562     0.0000141       0.00000200
    530 0.00000440     0.00000779      0.000000834
    540 0.0000192      0.0000182       0.00000133
    550 0.0000441      0.0000206       0.00000324
    560 0.0000871      0.0000261       0.00000309
    570 0.000135       0.0000307       0.00000290
    580 0.000172       0.0000347       0.00000240
    590 0.000181       0.0000292       0.00000201
    600 0.000152       0.0000225       0.00000117
    610 0.0000999      0.0000146       0.000000764
    620 0.0000489      0.00000740      0.000000380
    630 0.0000177      0.00000283      0.000000181
    640 0.00000231     0.000000391     0.00000000862
    650 0.00000145     0.000000245     0.00000000154
    660 0.00000141     0.000000220     0.00000000132
    670 0.000000398    0.0000000591    0.000000000493
    680 0.000000131    0.0000000191    0.0000000000524
    690 0.0000000275   0.00000000394   0.0000000000132
    700 0.0000000113   0.00000000160   0.00000000000493
    710 0.00000000351  0.000000000493  0.00000000000120
    720 0.000000000585 0.0000000000801 0.000000000000132
'''[1:-1]

from f import flt
from pdb import set_trace as xx 
flt(0).f = True
col = 4

print(f"Nimeroff column {col}")
for line in table4.split("\n"):
    f = [flt(i) for i in line.split()]
    f[0] = int(f[0])
    print(f[col-1])
